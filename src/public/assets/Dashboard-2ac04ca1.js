import{d as B,r as c,i as w,j as S,c as r,a as e,b as f,v as T,k as U,F as V,l as A,u as E,A as b,o as l,t as d,n as O,w as x,m as j,_ as N}from"./index-7fbbb612.js";import{G as C}from"./game-8f7145f9.js";import{u as F}from"./useToast-f56536f2.js";const H={class:"container"},I={class:"card"},z={style:{display:"flex",gap:"15px","align-items":"center","flex-wrap":"wrap"}},J={style:{flex:"1","min-width":"250px"}},P={style:{display:"flex",gap:"10px","align-items":"center"}},R={class:"checkbox-label",style:{display:"flex","align-items":"center",gap:"10px"}},q={class:"games-grid"},K={key:0,class:"empty-state"},Q=["onClick"],W={class:"game-card-header"},X={class:"game-info-column"},Y={class:"game-info-row"},Z={class:"game-name"},ee={class:"game-owner"},se={class:"game-info-row"},te={class:"game-card-actions"},oe=["onClick"],ae=["onClick"],ne=B({__name:"Dashboard",setup(ie){const u=E(),{addToast:m}=F(),h=c([]),k=c(!0),i=c(""),p=c(!1),v=w(()=>b.getCurrentUser()),_=w(()=>{const o=h.value.filter(s=>{var n;const t=s.name.toLowerCase().includes(i.value.toLowerCase())||s.description&&s.description.toLowerCase().includes(i.value.toLowerCase())||((n=s.owner)==null?void 0:n.name)&&s.owner.name.toLowerCase().includes(i.value.toLowerCase()),a=!p.value||y(s);return t&&a});return o.sort((s,t)=>{const a=s.activeConnections||0;return(t.activeConnections||0)-a}),o.slice(0,10)});S(()=>{g()});const g=async()=>{try{const o=await C.getGames();h.value=o}catch(o){m({message:"Error loading games: "+o.message,type:"error"})}finally{k.value=!1}},y=o=>!o.owner||!v.value?!1:o.owner.id===v.value.id,G=async o=>{if(confirm("Are you sure you want to delete this game? This action cannot be undone."))try{await C.deleteGame(o),m({message:"Game deleted successfully",type:"success"}),g()}catch(s){m({message:"Error deleting game: "+s.message,type:"error"})}},D=o=>{u.push(`/game/${o.id}`)},L=()=>{u.push("/create-game")},M=o=>{u.push(`/history?gameId=${o}`)},$=()=>{b.logout(),window.location.href="/login"};return(o,s)=>(l(),r("div",H,[e("div",{class:"header flex justify-between items-center"},[s[2]||(s[2]=e("h1",null,"Dashboard - Milsim Games",-1)),e("div",{class:"flex gap-2"},[e("button",{class:"btn btn-success",onClick:L}," Create Game "),e("button",{class:"btn btn-danger",onClick:$}," Logout ")])]),e("div",I,[e("div",z,[e("div",J,[f(e("input",{type:"text",placeholder:"Search by name, description or owner...",class:"form-input",style:{width:"100%"},"onUpdate:modelValue":s[0]||(s[0]=t=>i.value=t)},null,512),[[T,i.value]])]),e("div",P,[e("label",R,[f(e("input",{type:"checkbox","onUpdate:modelValue":s[1]||(s[1]=t=>p.value=t),style:{width:"20px",height:"20px"}},null,512),[[U,p.value]]),s[3]||(s[3]=e("span",null,"Mostrar solo mis juegos",-1))])])]),s[4]||(s[4]=e("div",{style:{height:"1px",background:"var(--border)",margin:"15px 0"}},null,-1)),e("div",q,[_.value.length===0?(l(),r("div",K," No games match the filters ")):(l(!0),r(V,{key:1},A(_.value,t=>{var a;return l(),r("div",{key:t.id,class:"game-card",onClick:n=>D(t)},[e("div",W,[e("div",X,[e("div",Y,[e("span",Z,d(t.name),1),e("span",ee,"Propietario: "+d(((a=t.owner)==null?void 0:a.name)||"Unknown"),1)]),e("div",se,[e("span",{class:O(`status-${t.status}`)},"Estado: "+d(t.status),3),e("span",null,"Jugadores: "+d(t.activeConnections||0),1)])]),e("div",te,[e("button",{class:"btn btn-success",onClick:x(n=>M(t.id),["stop"]),title:"View Game History"}," 🕒 ",8,oe),y(t)?(l(),r("button",{key:0,class:"btn btn-danger",onClick:x(n=>G(t.id),["stop"]),title:"Delete game"}," 🗑️ ",8,ae)):j("",!0)])])],8,Q)}),128))])])]))}});const de=N(ne,[["__scopeId","data-v-9b5cdde6"]]);export{de as default};
