import{d as B,r as o,j as V,i as A,c as l,a as t,t as v,p as F,b as w,z as b,F as M,l as N,f as O,u as L,o as r,n as H,_ as P}from"./index-5b40fb92.js";import{G as U}from"./game-d4e3b530.js";import{u as j}from"./useToast-ce2760a9.js";import{G as z}from"./GameResultsDialog-8ba17d5f.js";const E={class:"container"},W={class:"header flex justify-between items-center"},Y={key:0,class:"game-name"},$={class:"card"},q={class:"filter-section"},J={class:"filter-controls"},K={class:"filter-group"},Q={class:"filter-group"},X={key:0,class:"loading-state"},Z={key:1,class:"error-state"},ee={key:2,class:"empty-state"},te={key:3,class:"instances-container"},se={class:"instances-grid"},ae={class:"instance-card-header"},ne={class:"instance-name"},oe={class:"instance-players"},le={class:"instance-date"},re={class:"instance-card-actions"},ie=["onClick"],ce=B({__name:"GameHistory",setup(de){const k=L(),{addToast:I}=j(),c=o([]),m=o(!0),d=o(null),p=o(!1),_=o(void 0),f=o(""),h=o("desc"),g=o("all");V(()=>{const e=new URLSearchParams(window.location.search).get("gameId");e&&(f.value=e),G()});const G=async()=>{try{m.value=!0,d.value=null;const s=f.value?parseInt(f.value):void 0;if(!s){d.value="No game ID provided",m.value=!1;return}const e=await U.getGameInstances(s);c.value=e.filter(n=>n.status==="finished"||n.status==="stopped"),y()}catch(s){d.value="Error loading game instances: "+s.message,I({message:d.value,type:"error"})}finally{m.value=!1}},y=()=>{c.value.sort((s,e)=>{const n=new Date(s.createdAt).getTime(),i=new Date(e.createdAt).getTime();return h.value==="desc"?i-n:n-i})},D=A(()=>{if(g.value==="all")return c.value;const s=new Date,e=new Date(s.getFullYear(),s.getMonth(),s.getDate()),n=new Date(e);n.setDate(e.getDate()-e.getDay());const i=new Date(s.getFullYear(),s.getMonth(),1);return c.value.filter(a=>{const u=new Date(a.createdAt);switch(g.value){case"today":return u>=e;case"week":return u>=n;case"month":return u>=i;default:return!0}})}),R=()=>{},C=s=>{_.value=s,p.value=!0},S=()=>{p.value=!1,_.value=void 0},T=()=>{k.push("/dashboard")},x=s=>{const e=new Date(s);return e.toLocaleDateString()+" "+e.toLocaleTimeString()};return(s,e)=>{var n,i;return r(),l("div",E,[t("div",W,[t("div",null,[e[2]||(e[2]=t("h1",null,"Game History",-1)),c.value.length>0?(r(),l("p",Y," Game: "+v(((i=(n=c.value[0])==null?void 0:n.game)==null?void 0:i.name)||"Unknown"),1)):F("",!0)]),t("button",{class:"btn btn-secondary",onClick:T}," Back to Dashboard ")]),t("div",$,[t("div",q,[t("div",J,[t("div",K,[e[4]||(e[4]=t("label",{class:"filter-label"},"Sort by Date:",-1)),w(t("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>h.value=a),class:"filter-select",onChange:y},[...e[3]||(e[3]=[t("option",{value:"desc"},"Newest First",-1),t("option",{value:"asc"},"Oldest First",-1)])],544),[[b,h.value]])]),t("div",Q,[e[6]||(e[6]=t("label",{class:"filter-label"},"Date Range:",-1)),w(t("select",{"onUpdate:modelValue":e[1]||(e[1]=a=>g.value=a),class:"filter-select",onChange:R},[...e[5]||(e[5]=[t("option",{value:"all"},"All Dates",-1),t("option",{value:"today"},"Today",-1),t("option",{value:"week"},"This Week",-1),t("option",{value:"month"},"This Month",-1)])],544),[[b,g.value]])])])]),e[7]||(e[7]=t("div",{style:{height:"1px",background:"var(--border)",margin:"15px 0"}},null,-1)),m.value?(r(),l("div",X," Loading game instances... ")):d.value?(r(),l("div",Z,v(d.value),1)):D.value.length===0?(r(),l("div",ee," No game instances found ")):(r(),l("div",te,[t("div",se,[(r(!0),l(M,null,N(D.value,a=>{var u;return r(),l("div",{key:a.id,class:"instance-card"},[t("div",ae,[t("span",ne,v(a.name),1),t("span",{class:H(`status-${a.status}`)},"Status: "+v(a.status),3),t("span",oe,"Players: "+v(((u=a.players)==null?void 0:u.length)||0),1),t("span",le,v(x(a.createdAt)),1)]),t("div",re,[t("button",{class:"btn btn-primary",onClick:ue=>C(a.id),title:"View Results"}," View Results ",8,ie)])])}),128))])]))]),O(z,{isOpen:p.value,onClose:S,gameId:_.value,isGameInstance:!0},null,8,["isOpen","gameId"])])}}});const _e=P(ce,[["__scopeId","data-v-400fb19c"]]);export{_e as default};
